L'un des aspects ennuyeux du développement d'applications AR est que chaque fois que je teste mon application, je dois démarrer la caméra de l'appareil. Je vais vous apprendre un truc pour l'éviter en utilisant une vidéo préenregistrée comme celle-ci. L'utilisation d'une vidéo préenregistrée nous permet également de déboguer les applications de manière plus cohérente. Pour cela, nous devrons simuler l'API de démarrage de la caméra. Si vous vous en souvenez encore, il s'agit de la méthode navigator.mediaDevices.getUserMedia en JavaScript. Ce langage est extrêmement flexible et nous pouvons facilement la remplacer par une autre méthode. Dans cette méthode, nous retournerons une nouvelle promesse. Ensuite, à l'intérieur de cette promesse, nous créerons un élément vidéo. Nous définirons l'attribut source sur le chemin de notre vidéo préenregistrée, dans ce cas assets/mock_videos/course_banner1.mp4. Nous définirons également l'attribut loop lorsque la vidéo est prête à être lue

Nous allons le jouer et ensuite résoudre la promesse avec le flux vidéo. Maintenant, si nous exécutons la page web, elle utilisera la vidéo préenregistrée au lieu de démarrer la webcam, afin de nous permettre de réutiliser facilement ce morceau de code, j'ai créé une méthode d'aide appelée "mock with video". Ainsi, nous pouvons faire "import mock with video" depuis la bibliothèque "camera-mock.js", puis appeler cette méthode avec le chemin de la vidéo préenregistrée. Maintenant, nous pouvons supprimer ce morceau de code. Exécutons-le à nouveau. J'ai modifié un peu son comportement pour qu'il ne démarre pas automatiquement. Au lieu de cela, vous devrez le déclencher en cliquant sur le bouton de démarrage en haut. La raison en est que dans certains navigateurs, vous ne pouvez pas démarrer une vidéo par programme sans aucune interaction de l'utilisateur. Nous devons donc attendre que cet événement de clic se produise. C'est une fonction d'aide très utile car vous pouvez également la commenter facilement et revenir à la webcam. Parfois, je veux même juste tester avec une image au lieu d'une vidéo, dans ce cas, vous pouvez utiliser cette méthode "mock with image", mais cette fois, passez le chemin d'une image en format ".png". Exécutez à nouveau et vous verrez que cette fois, la vidéo de la webcam est simulée par une image. J'utilise cette technique souvent et j'espère que cela peut également vous faire gagner du temps.